<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cadastro de Produtos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-main">
        <div class="hero">
            <div class="hero-body">
                <h1 class="title has-text-white">
                    <i class="fas fa-box-open"></i> Sistema de Cadastro de Produtos
                </h1>
                <p class="subtitle has-text-white">
                    Gerencie seus produtos com facilidade
                </p>
            </div>
        </div>

        <div class="columns is-multiline">
            <!-- Formulário de Cadastro -->
            <div class="column is-12-mobile is-12-tablet is-5-desktop">
                <div class="box">
                    <h2 class="title is-4">
                        <i class="fas fa-plus-circle"></i> Cadastrar Produto
                    </h2>
                    
                    <form id="productForm">
                        <div class="field">
                            <label class="label">Descrição do Produto</label>
                            <div class="control">
                                <input class="input" type="text" id="descricao" placeholder="Ex: Arroz Tipo 1" required>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Preço de Custo (R$)</label>
                            <div class="control has-icons-left">
                                <input class="input" type="number" id="precoCusto" placeholder="0.00" step="0.01" min="0" required>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-dollar-sign"></i>
                                </span>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Unidade Métrica</label>
                            <div class="control">
                                <div class="select is-fullwidth">
                                    <select id="unidade">
                                        <option value="un">un - Unidade</option>
                                        <option value="pc">pc - Peça</option>
                                        <option value="sc">sc - Saco</option>
                                        <option value="pct">pct - Pacote</option>
                                        <option value="dz">dz - Duzia</option>
                                        <option value="fardo">fardo - Fardo</option>
                                        <option value="tubo">tubo - Tubo</option>
                                        <option value="barra">barra - Barra</option>
                                        <option value="metro">metro - Metro</option>
                                        <option value="225ml">225ml - 225ml</option>
                                        <option value="900ml">900ml - 900ml</option>
                                        <option value="galao">galão - Galão</option>
                                        <option value="lata">lata - Lata</option>
                                        <option value="kg">kg - Quilograma</option>
                                        <option value="caixa">caixa - Caixa</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="columns">
                            <div class="column">
                                <div class="field">
                                    <label class="label">Markup (%)</label>
                                    <div class="control">
                                        <input class="input" type="number" id="markup" placeholder="0" step="0.01" min="0" value="0">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <div class="field">
                                    <label class="label">Margem (%)</label>
                                    <div class="control">
                                        <input class="input" type="number" id="margem" placeholder="0" step="0.01" min="0" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="price-info">
                            <div class="field">
                                <label class="label">Preço de Venda (R$)</label>
                                <div class="control has-icons-left">
                                    <input class="input is-success" type="number" id="precoVenda" placeholder="0.00" step="0.01" min="0">
                                    <span class="icon is-small is-left">
                                        <i class="fas fa-dollar-sign"></i>
                                    </span>
                                </div>
                            </div>
                            <p class="help">Digite o preço de venda ou use markup/margem para calcular automaticamente</p>
                        </div>

                        <div class="field">
                            <label class="label">Código de Barras EAN13</label>
                            <div class="field has-addons">
                                <div class="control is-expanded">
                                    <input class="input" type="text" id="codigoBarras" placeholder="Digite ou gere automaticamente" maxlength="13">
                                </div>
                                <div class="control">
                                    <button type="button" class="button is-info" onclick="gerarEAN13()">
                                        <span class="icon">
                                            <i class="fas fa-barcode"></i>
                                        </span>
                                        <span>Gerar</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="field">
                            <label class="label">Quantidade</label>
                            <div class="control">
                                <input class="input" type="number" id="quantidade" placeholder="1" step="1" min="1" value="1" required>
                            </div>
                        </div>

                        <div class="field">
                            <div class="control">
                                <button type="submit" class="button is-primary is-fullwidth" id="btnSubmit">
                                    <span class="icon">
                                        <i class="fas fa-save"></i>
                                    </span>
                                    <span>Adicionar Produto</span>
                                </button>
                            </div>
                        </div>

                        <div class="field">
                            <div class="control">
                                <button type="button" class="button is-light is-fullwidth" onclick="limparFormulario()">
                                    <span class="icon">
                                        <i class="fas fa-eraser"></i>
                                    </span>
                                    <span>Limpar Formulário</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Lista de Produtos -->
            <div class="column is-12-mobile is-12-tablet is-7-desktop">
                <div class="box">
                    <h2 class="title is-4">
                        <i class="fas fa-list"></i> Lista de Produtos
                    </h2>

                    <div class="field is-grouped is-grouped-multiline">
                        <div class="control">
                            <button class="button is-danger" onclick="excluirSelecionados()">
                                <span class="icon">
                                    <i class="fas fa-trash"></i>
                                </span>
                                <span>Excluir Selecionados</span>
                            </button>
                        </div>
                        <div class="control">
                            <button class="button is-success" onclick="exportarExcel()">
                                <span class="icon">
                                    <i class="fas fa-file-excel"></i>
                                </span>
                                <span>Excel</span>
                            </button>
                        </div>
                        <div class="control">
                            <button class="button is-info" onclick="exportarCSV()">
                                <span class="icon">
                                    <i class="fas fa-file-csv"></i>
                                </span>
                                <span>CSV</span>
                            </button>
                        </div>
                        <div class="control">
                            <button class="button is-link" onclick="exportarPDF()">
                                <span class="icon">
                                    <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>PDF</span>
                            </button>
                        </div>
                        <div class="control">
                            <div class="file is-info">
                                <label class="file-label">
                                    <input class="file-input" type="file" id="importFile" accept=".csv,.xlsx" onchange="importarArquivo(event)">
                                    <span class="file-cta">
                                        <span class="file-icon">
                                            <i class="fas fa-upload"></i>
                                        </span>
                                        <span class="file-label">
                                            Importar
                                        </span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="table is-fullwidth is-striped is-hoverable" id="productsTable">
                            <thead>
                                <tr>
                                    <th><input type="checkbox" id="selectAll" onchange="selecionarTodos()"></th>
                                    <th>Descrição</th>
                                    <th>Preço Custo</th>
                                    <th>Preço Venda</th>
                                    <th>Unidade</th>
                                    <th>Markup</th>
                                    <th>Margem</th>
                                    <th>Qtd</th>
                                    <th>Subtotal</th>
                                    <th>Código</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="productsBody">
                                <tr>
                                    <td colspan="11" class="has-text-centered">Nenhum produto cadastrado</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="summary-box">
                        <div class="summary-item">
                            <span><strong>Total de Produtos:</strong></span>
                            <span id="totalProdutos">0</span>
                        </div>
                        <div class="summary-item">
                            <span><strong>Total Custo:</strong></span>
                            <span id="totalCusto">R$ 0,00</span>
                        </div>
                        <div class="summary-item">
                            <span><strong>Total Com Markup/Margem:</strong></span>
                            <span class="has-text-success" id="totalComMarkup">R$ 0,00</span>
                        </div>
                        <div class="summary-item">
                            <span><strong>Lucro Total:</strong></span>
                            <span class="has-text-info" id="lucroTotal">R$ 0,00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="./script.js"></script>
</body>
</html>